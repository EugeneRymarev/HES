@page "/Identity/Account/Manage"
@attribute [Authorize(Roles = ApplicationRoles.AdminRole)]

<HeaderComponent ActiveTab="HeaderComponent.ProfileActiveTab.Profile" />

@if (ProfileInputModel == null)
{
    <LoadingTab />
}
else
{
    <div class="card mb-2">
        <div class="card-body">
            <h4 class="text-navyblue">Profile</h4>
            <EditForm Model="ProfileInputModel" OnValidSubmit="SaveProfileAsync">
                <DataAnnotationsValidator />
                <div class="form-group" style="max-width:350px">
                    <label class="text-gray">Email</label>
                    <input @bind="ProfileInputModel.Email" class="form-control" />
                    <ValidationMessage For="@(() => ProfileInputModel.Email)" class="text-danger" />
                    @if (!ProfileInputModel.IsEmailConfirmed)
                    {
                        <button type="button" @onclick="SendVerificationEmailAsync" class="btn btn-link">Send verification email</button>
                    }
                </div>
                <div class="form-group" style="max-width:350px">
                    <label class="text-gray">Phone Number</label>
                    <input @bind="ProfileInputModel.PhoneNumber" class="form-control" />
                    <ValidationMessage For="@(() => ProfileInputModel.PhoneNumber)" class="text-danger" />
                </div>
                <div>
                    <button type="submit" class="btn btn-primary">Save profile</button>
                </div>
            </EditForm>
        </div>
    </div>
    <div class="card  mb-2">
        <div class="card-body">
            <h4 class="text-navyblue">Change Password</h4>
            <EditForm Model="PasswordInputModel" OnValidSubmit="ChangePasswordAsync">
                <DataAnnotationsValidator />
                <div class="form-group" style="max-width:350px">
                    <label class="text-gray">Current password</label>
                    <input type="password" @bind="PasswordInputModel.OldPassword" class="form-control" />
                    <ValidationMessage For="@(() => PasswordInputModel.OldPassword)" class="text-danger" />
                </div>
                <div class="form-group" style="max-width:350px">
                    <label class="text-gray">New password</label>
                    <input type="password" @bind="PasswordInputModel.NewPassword" class="form-control" />
                    <ValidationMessage For="@(() => PasswordInputModel.NewPassword)" class="text-danger" />
                </div>
                <div class="form-group" style="max-width:350px">
                    <label class="text-gray">Confirm new password</label>
                    <input type="password" @bind="PasswordInputModel.ConfirmPassword" class="form-control" />
                    <ValidationMessage For="@(() => PasswordInputModel.ConfirmPassword)" class="text-danger" />
                </div>

                <div>
                    <button type="submit" class="btn btn-primary">Save password</button>
                </div>
            </EditForm>
        </div>
    </div>
}